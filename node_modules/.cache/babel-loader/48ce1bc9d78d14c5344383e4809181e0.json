{"ast":null,"code":"'use strict'; //Const\n\nvar NOAH_ARK_CAPACITY = 3; //List of formatting elements\n\nvar FormattingElementList = module.exports = function (treeAdapter) {\n  this.length = 0;\n  this.entries = [];\n  this.treeAdapter = treeAdapter;\n  this.bookmark = null;\n}; //Entry types\n\n\nFormattingElementList.MARKER_ENTRY = 'MARKER_ENTRY';\nFormattingElementList.ELEMENT_ENTRY = 'ELEMENT_ENTRY'; //Noah Ark's condition\n//OPTIMIZATION: at first we try to find possible candidates for exclusion using\n//lightweight heuristics without thorough attributes check.\n\nFormattingElementList.prototype._getNoahArkConditionCandidates = function (newElement) {\n  var candidates = [];\n\n  if (this.length >= NOAH_ARK_CAPACITY) {\n    var neAttrsLength = this.treeAdapter.getAttrList(newElement).length,\n        neTagName = this.treeAdapter.getTagName(newElement),\n        neNamespaceURI = this.treeAdapter.getNamespaceURI(newElement);\n\n    for (var i = this.length - 1; i >= 0; i--) {\n      var entry = this.entries[i];\n      if (entry.type === FormattingElementList.MARKER_ENTRY) break;\n      var element = entry.element,\n          elementAttrs = this.treeAdapter.getAttrList(element),\n          isCandidate = this.treeAdapter.getTagName(element) === neTagName && this.treeAdapter.getNamespaceURI(element) === neNamespaceURI && elementAttrs.length === neAttrsLength;\n      if (isCandidate) candidates.push({\n        idx: i,\n        attrs: elementAttrs\n      });\n    }\n  }\n\n  return candidates.length < NOAH_ARK_CAPACITY ? [] : candidates;\n};\n\nFormattingElementList.prototype._ensureNoahArkCondition = function (newElement) {\n  var candidates = this._getNoahArkConditionCandidates(newElement),\n      cLength = candidates.length;\n\n  if (cLength) {\n    var neAttrs = this.treeAdapter.getAttrList(newElement),\n        neAttrsLength = neAttrs.length,\n        neAttrsMap = Object.create(null); //NOTE: build attrs map for the new element so we can perform fast lookups\n\n    for (var i = 0; i < neAttrsLength; i++) {\n      var neAttr = neAttrs[i];\n      neAttrsMap[neAttr.name] = neAttr.value;\n    }\n\n    for (i = 0; i < neAttrsLength; i++) {\n      for (var j = 0; j < cLength; j++) {\n        var cAttr = candidates[j].attrs[i];\n\n        if (neAttrsMap[cAttr.name] !== cAttr.value) {\n          candidates.splice(j, 1);\n          cLength--;\n        }\n\n        if (candidates.length < NOAH_ARK_CAPACITY) return;\n      }\n    } //NOTE: remove bottommost candidates until Noah's Ark condition will not be met\n\n\n    for (i = cLength - 1; i >= NOAH_ARK_CAPACITY - 1; i--) {\n      this.entries.splice(candidates[i].idx, 1);\n      this.length--;\n    }\n  }\n}; //Mutations\n\n\nFormattingElementList.prototype.insertMarker = function () {\n  this.entries.push({\n    type: FormattingElementList.MARKER_ENTRY\n  });\n  this.length++;\n};\n\nFormattingElementList.prototype.pushElement = function (element, token) {\n  this._ensureNoahArkCondition(element);\n\n  this.entries.push({\n    type: FormattingElementList.ELEMENT_ENTRY,\n    element: element,\n    token: token\n  });\n  this.length++;\n};\n\nFormattingElementList.prototype.insertElementAfterBookmark = function (element, token) {\n  var bookmarkIdx = this.length - 1;\n\n  for (; bookmarkIdx >= 0; bookmarkIdx--) {\n    if (this.entries[bookmarkIdx] === this.bookmark) break;\n  }\n\n  this.entries.splice(bookmarkIdx + 1, 0, {\n    type: FormattingElementList.ELEMENT_ENTRY,\n    element: element,\n    token: token\n  });\n  this.length++;\n};\n\nFormattingElementList.prototype.removeEntry = function (entry) {\n  for (var i = this.length - 1; i >= 0; i--) {\n    if (this.entries[i] === entry) {\n      this.entries.splice(i, 1);\n      this.length--;\n      break;\n    }\n  }\n};\n\nFormattingElementList.prototype.clearToLastMarker = function () {\n  while (this.length) {\n    var entry = this.entries.pop();\n    this.length--;\n    if (entry.type === FormattingElementList.MARKER_ENTRY) break;\n  }\n}; //Search\n\n\nFormattingElementList.prototype.getElementEntryInScopeWithTagName = function (tagName) {\n  for (var i = this.length - 1; i >= 0; i--) {\n    var entry = this.entries[i];\n    if (entry.type === FormattingElementList.MARKER_ENTRY) return null;\n    if (this.treeAdapter.getTagName(entry.element) === tagName) return entry;\n  }\n\n  return null;\n};\n\nFormattingElementList.prototype.getElementEntry = function (element) {\n  for (var i = this.length - 1; i >= 0; i--) {\n    var entry = this.entries[i];\n    if (entry.type === FormattingElementList.ELEMENT_ENTRY && entry.element === element) return entry;\n  }\n\n  return null;\n};","map":{"version":3,"names":["NOAH_ARK_CAPACITY","FormattingElementList","module","exports","treeAdapter","length","entries","bookmark","MARKER_ENTRY","ELEMENT_ENTRY","prototype","_getNoahArkConditionCandidates","newElement","candidates","neAttrsLength","getAttrList","neTagName","getTagName","neNamespaceURI","getNamespaceURI","i","entry","type","element","elementAttrs","isCandidate","push","idx","attrs","_ensureNoahArkCondition","cLength","neAttrs","neAttrsMap","Object","create","neAttr","name","value","j","cAttr","splice","insertMarker","pushElement","token","insertElementAfterBookmark","bookmarkIdx","removeEntry","clearToLastMarker","pop","getElementEntryInScopeWithTagName","tagName","getElementEntry"],"sources":["D:/ReactJS-Ecommerce/react-ecommerce/node_modules/react-render-html/node_modules/parse5/lib/parser/formatting_element_list.js"],"sourcesContent":["'use strict';\n\n//Const\nvar NOAH_ARK_CAPACITY = 3;\n\n//List of formatting elements\nvar FormattingElementList = module.exports = function (treeAdapter) {\n    this.length = 0;\n    this.entries = [];\n    this.treeAdapter = treeAdapter;\n    this.bookmark = null;\n};\n\n//Entry types\nFormattingElementList.MARKER_ENTRY = 'MARKER_ENTRY';\nFormattingElementList.ELEMENT_ENTRY = 'ELEMENT_ENTRY';\n\n//Noah Ark's condition\n//OPTIMIZATION: at first we try to find possible candidates for exclusion using\n//lightweight heuristics without thorough attributes check.\nFormattingElementList.prototype._getNoahArkConditionCandidates = function (newElement) {\n    var candidates = [];\n\n    if (this.length >= NOAH_ARK_CAPACITY) {\n        var neAttrsLength = this.treeAdapter.getAttrList(newElement).length,\n            neTagName = this.treeAdapter.getTagName(newElement),\n            neNamespaceURI = this.treeAdapter.getNamespaceURI(newElement);\n\n        for (var i = this.length - 1; i >= 0; i--) {\n            var entry = this.entries[i];\n\n            if (entry.type === FormattingElementList.MARKER_ENTRY)\n                break;\n\n            var element = entry.element,\n                elementAttrs = this.treeAdapter.getAttrList(element),\n                isCandidate = this.treeAdapter.getTagName(element) === neTagName &&\n                              this.treeAdapter.getNamespaceURI(element) === neNamespaceURI &&\n                              elementAttrs.length === neAttrsLength;\n\n            if (isCandidate)\n                candidates.push({idx: i, attrs: elementAttrs});\n        }\n    }\n\n    return candidates.length < NOAH_ARK_CAPACITY ? [] : candidates;\n};\n\nFormattingElementList.prototype._ensureNoahArkCondition = function (newElement) {\n    var candidates = this._getNoahArkConditionCandidates(newElement),\n        cLength = candidates.length;\n\n    if (cLength) {\n        var neAttrs = this.treeAdapter.getAttrList(newElement),\n            neAttrsLength = neAttrs.length,\n            neAttrsMap = Object.create(null);\n\n        //NOTE: build attrs map for the new element so we can perform fast lookups\n        for (var i = 0; i < neAttrsLength; i++) {\n            var neAttr = neAttrs[i];\n\n            neAttrsMap[neAttr.name] = neAttr.value;\n        }\n\n        for (i = 0; i < neAttrsLength; i++) {\n            for (var j = 0; j < cLength; j++) {\n                var cAttr = candidates[j].attrs[i];\n\n                if (neAttrsMap[cAttr.name] !== cAttr.value) {\n                    candidates.splice(j, 1);\n                    cLength--;\n                }\n\n                if (candidates.length < NOAH_ARK_CAPACITY)\n                    return;\n            }\n        }\n\n        //NOTE: remove bottommost candidates until Noah's Ark condition will not be met\n        for (i = cLength - 1; i >= NOAH_ARK_CAPACITY - 1; i--) {\n            this.entries.splice(candidates[i].idx, 1);\n            this.length--;\n        }\n    }\n};\n\n//Mutations\nFormattingElementList.prototype.insertMarker = function () {\n    this.entries.push({type: FormattingElementList.MARKER_ENTRY});\n    this.length++;\n};\n\nFormattingElementList.prototype.pushElement = function (element, token) {\n    this._ensureNoahArkCondition(element);\n\n    this.entries.push({\n        type: FormattingElementList.ELEMENT_ENTRY,\n        element: element,\n        token: token\n    });\n\n    this.length++;\n};\n\nFormattingElementList.prototype.insertElementAfterBookmark = function (element, token) {\n    var bookmarkIdx = this.length - 1;\n\n    for (; bookmarkIdx >= 0; bookmarkIdx--) {\n        if (this.entries[bookmarkIdx] === this.bookmark)\n            break;\n    }\n\n    this.entries.splice(bookmarkIdx + 1, 0, {\n        type: FormattingElementList.ELEMENT_ENTRY,\n        element: element,\n        token: token\n    });\n\n    this.length++;\n};\n\nFormattingElementList.prototype.removeEntry = function (entry) {\n    for (var i = this.length - 1; i >= 0; i--) {\n        if (this.entries[i] === entry) {\n            this.entries.splice(i, 1);\n            this.length--;\n            break;\n        }\n    }\n};\n\nFormattingElementList.prototype.clearToLastMarker = function () {\n    while (this.length) {\n        var entry = this.entries.pop();\n\n        this.length--;\n\n        if (entry.type === FormattingElementList.MARKER_ENTRY)\n            break;\n    }\n};\n\n//Search\nFormattingElementList.prototype.getElementEntryInScopeWithTagName = function (tagName) {\n    for (var i = this.length - 1; i >= 0; i--) {\n        var entry = this.entries[i];\n\n        if (entry.type === FormattingElementList.MARKER_ENTRY)\n            return null;\n\n        if (this.treeAdapter.getTagName(entry.element) === tagName)\n            return entry;\n    }\n\n    return null;\n};\n\nFormattingElementList.prototype.getElementEntry = function (element) {\n    for (var i = this.length - 1; i >= 0; i--) {\n        var entry = this.entries[i];\n\n        if (entry.type === FormattingElementList.ELEMENT_ENTRY && entry.element === element)\n            return entry;\n    }\n\n    return null;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}